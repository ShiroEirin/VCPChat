[根目录](../../CLAUDE.md) > **Assistantmodules**

# Assistantmodules AI助手模块

## 变更记录 (Changelog)

- 2025-09-30 19:47:17: 初始化模块文档

## 模块职责

Assistantmodules 提供 AI 助手功能，包括智能划词助手、Agent 管理界面和 AI 交互增强功能。该模块使用户能够更便捷地与 AI 进行交互，并提供全局范围内的智能服务。

## 模块结构

### 核心文件
- **assistant.html** - AI助手主界面
- **assistant.js** - AI助手核心逻辑
- **assistant.css** - AI助手样式文件
- **assistant-bar.html** - 划词助手工具栏
- **assistant-bar.js** - 划词助手核心逻辑

## 核心功能特性

### 划词助手 (Selection Assistant)
- **全局文本监听** - 在任何应用程序中监听鼠标划选文本
- **悬浮动作条** - 划选文本后显示快捷操作工具栏
- **智能操作** - 提供翻译、总结、解释、搜索、配图等快捷操作
- **独立对话窗口** - 为每个操作创建独立的轻量聊天窗口
- **无缝体验** - 无需离开当前工作窗口即可获得AI服务

### AI助手界面
- **Agent管理** - 创建、配置和管理多个AI Agent
- **系统提示设置** - 为每个Agent设置个性化的系统提示
- **参数调整** - 温度、上下文长度、最大输出等参数配置
- **头像管理** - Agent头像上传和管理
- **话题管理** - 每个Agent支持多个独立聊天话题

### 智能交互
- **上下文感知** - 根据当前应用和内容提供相关建议
- **个性化服务** - 记忆用户偏好和使用习惯
- **多模态支持** - 支持文本、图片、音频等多种输入格式
- **快捷操作** - 常用功能的快速访问和执行

## 技术实现

### 划词监听机制
- 使用 `selection-hook` 库进行全局文本选择监听
- 通过 Electron 的全局快捷键和系统级API实现跨应用操作
- 智能识别不同应用的文本选择事件

### 工具栏渲染
- 动态创建悬浮工具栏DOM元素
- 计算最佳显示位置避免遮挡内容
- 响应式设计适配不同屏幕尺寸

### Agent通信
- 通过 IPC 与主进程通信
- 调用 VCP 服务器的 AI 接口
- 实时流式响应处理

## 配置选项

### 全局设置
- **启用划词助手** - 开关全局划词功能
- **快捷键配置** - 自定义激活快捷键
- **默认Agent** - 设置默认使用的AI Agent
- **操作权限** - 配置允许的操作类型

### Agent设置
- **名称和描述** - Agent的基本信息
- **系统提示** - 定义Agent的角色和行为
- **模型参数** - 温度、top_p、最大长度等
- **权限设置** - 文件访问、网络请求等权限

## 使用场景

### 学习辅助
- 划选不懂的单词进行翻译
- 选中复杂概念请求解释
- 总结长篇文章的关键点

### 工作提效
- 快速生成代码注释
- 优化和重构代码片段
- 生成文档和报告

### 创作支持
- 为选中内容配图
- 扩展思路和创意
- 校对和改进文本

## 常见问题 (FAQ)

### Q: 划词助手在某些应用中不工作？
A: 某些应用可能限制了文本选择访问，可以尝试使用不同的选择方式或检查权限设置。

### Q: 如何添加自定义操作？
A: 可以在设置中添加自定义操作模板，定义操作的提示词和参数。

### Q: Agent 配置如何备份和恢复？
A: 配置文件存储在 AppData 目录，可以直接复制备份，或使用导出/导入功能。

## 相关文件清单

### 核心文件
- assistant.html - AI助手主界面
- assistant.js - 核心逻辑实现
- assistant.css - 样式定义
- assistant-bar.html - 划词工具栏
- assistant-bar.js - 划词逻辑

### 依赖文件
- 依赖主进程的 selection-hook 模块
- 依赖 VCP 服务器的 AI 接口
- 依赖 modules/assistantHandlers.js

---

*本文档由 AI 自动生成，最后更新时间: 2025-09-30 19:47:17*